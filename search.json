[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!\n\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts."
  },
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "Live at the OPRA - Watching options order flow",
    "section": "",
    "text": "I trade options via Interactive Brokers and their Trader Workstation software. At a certain point, though, I realized their option chain interface did not always show the true last price a particular option traded at. Bid-ask info would be updated continuously, but not necessarily last price. I was then potentially getting a false sense of what was actually happening at any given strike and actually missing out on useful information. And the thing is, I pay for real-time data from the exchanges via IBKR, so there was no good reason to be seeing stale price data.\nI remembered that Databento offers real-time OPRA data feeds, so I decided to sign up for that. It’s $199/mo, but I would argue it’s been totally worth it to see options order flow in real-time all throughout the trading day. You also get statistics about all the options you’re interested in when the exchanges close for the day.\nThis code sample doesn’t deviate much from the sample Databento offers to get you started with live data, but for a while this is what I used to watch real-time options order flow every weekday.\n\nimport databento as db\n\ndb.enable_logging(\"INFO\")\n\nsymbols = [\"GS    251219C00850000\",]\n\nlive_client = db.Live(API_KEY)\n\nlive_client.subscribe(\n    dataset = \"OPRA.PILLAR\",\n    schema = \"status\",\n    symbols = symbols,\n    stype_in = \"raw_symbol\",\n)\n\nlive_client.subscribe(\n    dataset = \"OPRA.PILLAR\",\n    schema = \"tcbbo\",\n    symbols = symbols,\n    stype_in = \"raw_symbol\",\n)\n\nlive_client.subscribe(\n    dataset = \"OPRA.PILLAR\",\n    schema = \"statistics\",\n    symbols = symbols,\n    stype_in = \"raw_symbol\",\n)\n\nlive_client.add_callback(print)\nlive_client.start()\n\nThis turned into:\n\n\n\nOPRA data flow from Databento in MacOS Terminal\n\n\nUnfortunately, the raw output from the feed is very hard to read and follow what is happening with the options you’re interested in.\nIn particular, the feed shows which option is which in the order flow via the instrument_id, but it’s a number, not a somewhat human-readable identifier (with issuer, date, and strike such as GS 251219C00850000). Or even better, a Goldman Sachs December 2025 850 call. The feed gives you a listing of what instrument_id is tied to which option and strike, but that happens when the feed first launches. After that, there’s no easy way to know what you’re looking at. That calls for some modifications!\nI cooked up something that makes order flow much more readable.\n\nimport os\nimport databento as db\n\n# Prices don't come in 2-decimal form\nOPT_PRICE_DIV = 1000000000\n\nsymbol_mappings = {}\n\ndef order_flow_print(order_flow_data):\n    msg_type = type(order_flow_data)\n\n    if(msg_type == db.SymbolMappingMsg):\n        instrument_id = order_flow_data.instrument_id\n        issuer_symbol = order_flow_data.stype_out_symbol\n        symbol_mappings[instrument_id] = issuer_symbol\n    elif(msg_type == db.CMBP1Msg):\n        header = order_flow_data.hd\n        instrument_id = header.instrument_id\n        order_price = order_flow_data.price / OPT_PRICE_DIV\n        order_size = order_flow_data.size\n        symbol_str = symbol_mappings[instrument_id]\n\n        bid_ask = order_flow_data.levels[0]\n        bid_price = bid_ask.bid_px / OPT_PRICE_DIV\n        ask_price = bid_ask.ask_px / OPT_PRICE_DIV\n        print(f\"{ symbol_str } - { order_size } @ ${ order_price }\")\n        print(f\"Bid: { bid_price }x{ bid_ask.bid_sz }  Ask: { ask_price }x{ bid_ask.ask_sz}\\n\")\n    \nif __name__ == \"__main__\":\n    try:\n        databento_api_key = os.getenv(\"DATABENTO_API_KEY\")\n        live_client = db.Live(databento_api_key)\n    except KeyError:\n        print(\"Oops! DATABENTO_API_KEY not found...\")\n\n    # Show all the order flow for a given issuer (in this case, Goldman Sachs and JP Morgan)\n    symbols = [\"GS.OPT\", \"JPM.OPT\", ]\n\n    live_client.subscribe(\n        dataset = \"OPRA.PILLAR\",\n        schema = \"status\",\n        symbols = symbols,\n        stype_in = \"parent\",\n    )\n\n    live_client.subscribe(\n        dataset = \"OPRA.PILLAR\",\n        schema = \"tcbbo\",\n        symbols = symbols,\n        stype_in = \"parent\",\n    )\n\n    live_client.subscribe(\n        dataset = \"OPRA.PILLAR\",\n        schema = \"statistics\",\n        symbols = symbols,\n        stype_in = \"parent\",\n    )\n\n    live_client.add_callback(order_flow_print)\n    live_client.start()\n\nAnd with much more readable output:\n\n\n\nUpdated OPRA order data flow from Databento in MacOS Terminal\n\n\nOf course, it could be improved even from here, but that’s for another day. CFA and CMT studying awaits…"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Musings",
    "section": "",
    "text": "Live at the OPRA - Watching options order flow\n\n\n\ncode\n\noptions\n\nmarket microstructure\n\n\n\n\n\n\n\n\n\nNov 2, 2025\n\n\nTiffani Ashley Bell\n\n\n\n\n\n\n\n\n\n\n\n\nWelcome To My Blog\n\n\n\nnews\n\n\n\n\n\n\n\n\n\nOct 30, 2025\n\n\nTiffani Ashley Bell\n\n\n\n\n\nNo matching items"
  }
]